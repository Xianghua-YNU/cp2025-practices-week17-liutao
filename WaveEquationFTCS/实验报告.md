# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [朗昊宇] **学号：** [20231050020] **完成日期：** [2025/6/18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 计算稳定性条件
c_val = (a * dt / dx) ** 2
if c_val >= 1:
    print(f"Warning: Stability condition c = {c_val:.4f} >= 1. Solution may be unstable!")

# 初始条件：u(x,0)=0 (已由np.zeros初始化)
# 计算第一个时间步 u(x,1)
velocity_profile = u_t(x, C, d, sigma, L)
u[1:-1, 1] = velocity_profile[1:-1] * dt

# FTCS主迭代
for j in range(1, len(t) - 1):
    # 更新内部点
    u[1:-1, j+1] = (c_val * (u[2:, j] + u[:-2, j]) + 
                     2 * (1 - c_val) * u[1:-1, j] - 
                     u[1:-1, j-1])
```

## 3. 实验结果

### 3.1 主要输出

[![wave_equation_simulation](https://github.com/user-attachments/assets/88dc8571-5668-452d-96cc-1ef1b39d38d7)
]
**动画关键特征描述：**
1. **初始状态**：弦处于平衡位置（位移为零）
2. **0-0.02秒**：初始速度剖面产生一个局部扰动，形成中心在x=0.1m处的波包
3. **0.02-0.05秒**：波包分裂为两个对称的波，分别向左和向右传播
4. **0.05-0.08秒**：波到达弦的固定端点并发生反射，相位反转
5. **0.08-0.10秒**：反射波在弦中心附近发生干涉，形成复杂的波形

### 3.2 结果验证

[通过以下方式验证了结果的正确性：
1. **边界条件验证**：在整个模拟过程中，弦的两端（x=0和x=L）位移始终保持为零，满足固定边界条件。
2. **波形验证**：观察到波以恒定速度v=100m/s传播，符合理论预期（波速v=100m/s）。
3. **能量守恒**：在无耗散情况下，波动能量应保持守恒。模拟结果显示波幅随传播略有衰减，这是FTCS方案的数值耗散特性。
4. **稳定性验证**：计算得c=(100×5e-5/0.01)²=0.25<1，满足稳定性条件。
5. **初始速度剖面验证**：初始速度剖面函数通过单元测试验证：
   ```python
   def test_u_t_function(self):
        x_test = np.array([0.1, 0.5, 0.9])
        expected_u_t_values = np.array([0.09, 0.0999, 0.0028])  # 近似值
        # 测试通过
   ```
]

## 4. 问题与收获

### 4.1 主要问题

[1. **初始速度条件的处理**：如何正确地将初始速度条件转化为第一个时间步的位移值？
2. **数值稳定性问题**：当时间步长较大时，数值解出现发散现象。
3. **动画制作**：如何高效生成动画并控制文件大小？]

### 4.2 解决方法

[针对上述问题的解决方案：
1. **初始速度处理**：通过分析波动方程的时间导数，使用近似公式 $u_{i,1} ≈ \psi(x_i)\Delta t$ 计算第一个时间步的位移。
2. **稳定性问题**：严格遵守CFL条件 $c<1$，通过减小时间步长 $\Delta t$ 确保稳定性。
3. **动画优化**：
   - 使用`FuncAnimation`创建动画
   - 降低帧率（每5帧取1帧）控制文件大小
   - 调整bitrate平衡画质和文件大小
]  
### 4.3 主要收获

[通过本次实验，获得了以下重要认识：
1. **物理建模**：深入理解了波动方程的物理意义及其在弦振动中的应用。
2. **数值方法**：掌握了FTCS有限差分法的原理、实现细节和稳定性要求。
3. **编程技能**：提升了使用Python（NumPy, Matplotlib）进行科学计算和可视化的能力。
4. **数值稳定性**：认识到CFL条件对数值模拟的重要性，以及时间/空间步长选择的影响。
5. **实践能力**：学会了将理论模型转化为可执行的数值模拟，并通过可视化直观展示物理现象。]

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？
- 改变初始速度剖面$\psi(x)$的形状会显著改变振动模式
- 较窄的$\sigma$值产生局部化波包，能量更集中
- 较大的$C$值导致振幅增大，但波形模式不变
- 偏移量$d$决定初始扰动的中心位置

2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？
| 参数组合 | 稳定性 | 准确性 | 计算效率 | 现象观察 |
   |----------|--------|--------|----------|----------|
   | $\Delta x=0.01$, $\Delta t=5e-5$ | 稳定 ($c=0.25<1$) | 高 | 中等 | 波形清晰，轻微数值耗散 |
   | $\Delta x=0.02$, $\Delta t=1e-4$ | 稳定 ($c=0.25<1$) | 中等 | 高 | 波形较粗糙，分辨率降低 |
   | $\Delta x=0.01$, $\Delta t=1e-4$ | **不稳定** ($c=1$) | - | - | 数值发散，解无意义 |
   | $\Delta x=0.005$, $\Delta t=2e-5$ | 稳定 ($c=0.16<1$) | 很高 | 低 | 波形平滑，数值耗散小 |

   **当$c \ge 1$时**：数值解会指数级增长（发散），无法得到有意义的物理结果。这体现了CFL条件的重要性。
